{ "name" : "PurchaseOrder" , "attributes" : [ { "name" : "_code" , "type" : "Text" , "isSystem" : true , "isReadOnly" : false , "description" : null , "multiplicity" : { "lower" : 1 , "upper" : 1 } , "aggregationKind" : "None" , "isSensitiveData" : false , "dependsOnAttribute" : null } , { "name" : "_serie" , "type" : "PurchaseOrderSerie" , "isSystem" : true , "isReadOnly" : false , "description" : null , "multiplicity" : { "lower" : 1 , "upper" : 1 } , "aggregationKind" : "Shared" , "isSensitiveData" : false , "dependsOnAttribute" : null } , { "name" : "_number" , "type" : "Integer" , "isSystem" : true , "isReadOnly" : true , "description" : null , "multiplicity" : { "lower" : 0 , "upper" : 1 } , "aggregationKind" : "None" , "isSensitiveData" : false , "dependsOnAttribute" : null } , { "name" : "_date" , "type" : "Date" , "isSystem" : true , "isReadOnly" : false , "description" : null , "multiplicity" : { "lower" : 1 , "upper" : 1 } , "aggregationKind" : "None" , "isSensitiveData" : false , "dependsOnAttribute" : null } , { "name" : "Supplier" , "type" : "Supplier" , "isSystem" : false , "isReadOnly" : false , "description" : "" , "multiplicity" : { "lower" : 1 , "upper" : 1 } , "aggregationKind" : "Shared" , "isSensitiveData" : false , "dependsOnAttribute" : "" } , { "name" : "Lines" , "type" : "PurchaseOrderLine" , "isSystem" : false , "isReadOnly" : false , "description" : "" , "multiplicity" : { "lower" : 0 , "upper" : 100 } , "aggregationKind" : "Composite" , "isSensitiveData" : false , "dependsOnAttribute" : "" } , { "name" : "TotalWithVat" , "type" : "Decimal" , "isSystem" : false , "isReadOnly" : true , "description" : "" , "multiplicity" : { "lower" : 1 , "upper" : 1 } , "aggregationKind" : "None" , "isSensitiveData" : false , "dependsOnAttribute" : "" } , { "name" : "TotalWithoutVat" , "type" : "Decimal" , "isSystem" : false , "isReadOnly" : true , "description" : "" , "multiplicity" : { "lower" : 1 , "upper" : 1 } , "aggregationKind" : "None" , "isSensitiveData" : false , "dependsOnAttribute" : "" } , { "name" : "VatTotal" , "type" : "Decimal" , "isSystem" : false , "isReadOnly" : true , "description" : "" , "multiplicity" : { "lower" : 1 , "upper" : 1 } , "aggregationKind" : "None" , "isSensitiveData" : false , "dependsOnAttribute" : "" } , { "name" : "_state" , "type" : "PurchaseOrderStateMachineStates" , "isSystem" : true , "isReadOnly" : false , "description" : null , "multiplicity" : { "lower" : 1 , "upper" : 1 } , "aggregationKind" : "None" , "isSensitiveData" : false , "dependsOnAttribute" : null } , { "name" : "_assigned" , "type" : "Text" , "isSystem" : true , "isReadOnly" : false , "description" : null , "multiplicity" : { "lower" : 0 , "upper" : 1 } , "aggregationKind" : "None" , "isSensitiveData" : false , "dependsOnAttribute" : null } ] , "dataSource" : "System" , "description" : "" , "dataBehaviours" : [ ] , "entityBehaviours" : [ { "name" : "Defaults" , "type" : "Initialize" , "attribute" : null , "expression" : "if(!_Context.Operation.IsNew) return; \nthis._code \u003d Guid.NewGuid().ToString(\"N\");\nthis._date \u003d DateTime.Today;\n\nvar httpClient \u003d _Context.CreateApplicationHttpClient();\nvar serieRequest \u003d httpClient.PostAsJsonAsync($\"Queries/{this.GetType().Name}SerieQuery/Default?PageSize\u003d1\",\n        new { Filter \u003d new { Property \u003d \"_inactive\", Value \u003d false } })\n    .GetAwaiter().GetResult();\n\nif (serieRequest.IsSuccessStatusCode)\n{\n    var serieRequestData \u003d serieRequest.Content.ReadAsAsync\u003cList\u003cDictionary\u003cstring, object\u003e\u003e\u003e()\n                            .GetAwaiter().GetResult();\n\n    if(serieRequestData.Any())\n        this._serie \u003d serieRequestData.First()[\"_code\"].ToString();\n}\n" , "description" : null } , { "name" : "VatTotal_Formula" , "type" : "Formula" , "attribute" : "VatTotal" , "expression" : "return this.TotalWithVat - this.TotalWithoutVat;" , "description" : "" } , { "name" : "TotalWithVat_Formula" , "type" : "Formula" , "attribute" : "TotalWithVat" , "expression" : "double tot \u003d 0.0;\nforeach (var line in this.Lines)\n{\n    tot +\u003d (double)line.TotalWithVat;\n}\nreturn (decimal)tot;" , "description" : "" } , { "name" : "TotalWithoutVat_Formula" , "type" : "Formula" , "attribute" : "TotalWithoutVat" , "expression" : "double tot \u003d 0.0;\nforeach (var line in this.Lines)\n{\n    tot +\u003d (double)line.Value;\n}\nreturn (decimal)tot;" , "description" : "" } ] , "behaviourNamespaces" : [ ] }